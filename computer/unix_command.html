<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8">
        <title>UNIX Command 常用指令</title>
        <link rel="stylesheet" href="http://blog.suhen.org/theme/css/main.css">
                <link href="http://blog.suhen.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title=" Suhen's blog Atom Feed" />
                
        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://blog.suhen.org/"> Suhen's blog </a></h1>
                <nav><ul>
                                                                                <li class="active"><a href="http://blog.suhen.org/category/computer.html">電腦</a></li>
                                <li ><a href="http://blog.suhen.org/category/music.html">音樂</a></li>
                                <li ><a href="http://blog.suhen.org/category/run.html">跑步</a></li>
                                <li ><a href="http://blog.suhen.org/category/mountain.html">爬山</a></li>
                                <li ><a href="http://blog.suhen.org/category/nature.html">自然</a></li>
                                <li ><a href="http://blog.suhen.org/category/travel.html">旅遊</a></li>
                                <li ><a href="http://blog.suhen.org/category/book.html">書</a></li>
                                <li ><a href="http://blog.suhen.org/category/language.html">語言</a></li>
                                <li ><a href="http://blog.suhen.org/category/misc.html">其他</a></li>
                                                </ul></nav>
        </header><!-- /#banner -->
        <section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://blog.suhen.org/computer/unix_command.html" rel="bookmark"
           title="Permalink to UNIX Command 常用指令">UNIX Command 常用指令</a></h1>
          </header>

    <div class="entry-content">
      <footer class="post-info">
        <abbr class="published" title="2013-03-28T00:00:00">
                2013-03-28 00:00
        </abbr>

        <p>In <a href="http://blog.suhen.org/category/computer.html">computer</a>. </p>
<p>tags: <a href="http://blog.suhen.org/tag/docs.html">docs</a></p>
</footer><!-- /.post-info -->      <div class="section" id="script">
<h2>好用script</h2>
<p>把&quot;/t&quot;分隔的檔案轉成sql語法, 用awk和sed</p>
<div class="highlight"><pre>awk -F <span class="s1">&#39;\t&#39;</span> <span class="s1">&#39;{print &quot;INSERT INTO word (\&quot;s3id\&quot;,\&quot;content\&quot;,\&quot;freq\&quot;,\&quot;translate\&quot;,\&quot;ex1\&quot;,\&quot;ex1_translate\&quot;,\&quot;ex2\&quot;,\&quot;ex2_translate\&quot;) VALUES(\&quot;&quot;$1&quot;\&quot;,\&quot;&quot;$2&quot;\&quot;,\&quot;&quot;$3&quot;\&quot;,\&quot;&quot;$4&quot;\&quot;,\&quot;&quot;$5&quot;\&quot;,\&quot;&quot;$6&quot;\&quot;,\&quot;&quot;$7&quot;\&quot;,\&quot;&quot;$8&quot;\&quot;);&quot;}&#39;</span> data_all_u.txt | sed -e <span class="s1">&#39;s/^M//g&#39;</span> &gt; out.sql
</pre></div>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">先用awk轉好, 再用sed去除最後換行符號, &quot;^M&quot;在commend-line裡要Ctrl-V + Ctrl-M表示</p>
</div>
</div>
<div class="section" id="id1">
<h2>檔案</h2>
<p>把檔案foo複製到以下全部目錄裡:</p>
<pre class="literal-block">
$ find . -type d |xargs -n 1 cp -i foo
</pre>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">xargs -n 1:</th><td class="field-body">把每一行command line輸出當作一個參數</td>
</tr>
<tr class="field"><th class="field-name">cp -i:</th><td class="field-body">詢問y or n</td>
</tr>
</tbody>
</table>
<div class="section" id="id2">
<h3>改檔名</h3>
<p>大寫改小寫:</p>
<pre class="literal-block">
$ for i in $( ls | grep [A-Z] ); do mv -i $i `echo $i | tr 'A-Z' 'a-z'`; done
</pre>
<p>只取數字, JPG改jpg:</p>
<pre class="literal-block">
for i in *.JPG ; do mv &quot;$i&quot; `echo $i | tr -dc '[0-9]'`&quot;.jpg&quot; ; done
</pre>
<p>for loop:</p>
<pre class="literal-block">
for f in *.html; do
    base=`basename $f .html`
    mv $f $bae.php
done
</pre>
</div>
<div class="section" id="id3">
<h3>找檔案</h3>
<p>找目錄名稱:</p>
<pre class="literal-block">
$ find / -type d -name &quot;dir_name&quot;
</pre>
<p>刪除5分鐘內建立的檔案:</p>
<pre class="literal-block">
$ find -cmin -5 -type f -exec rm -rf {} \;
</pre>
<p>找出體積最大前十檔案/目錄:</p>
<pre class="literal-block">
$ du -a /home | sort -n -r | head -n 10
</pre>
<p>via: <a class="reference external" href="http://www.hkcode.com/linux-bsd-notes/693">Linux 下找出體積最大的檔案/目錄 – 網絡技術日誌</a></p>
<p>某目錄下的全部檔案的字串:</p>
<pre class="literal-block">
$ grep -rl flaskext . |xargs sed -i -e 's/flaskext/flask.ext/'
</pre>
<p>via: <a class="reference external" href="http://www.commandlinefu.com/commands/view/4698/recursive-search-and-replace-old-with-new-string-inside-files">recursive search and replace old with new string, inside files | commandlinefu.com</a></p>
<p>列出各目錄大小(不顯示子目錄):</p>
<pre class="literal-block">
du -h | grep -v '[a-z]/.'
</pre>
<p>coding convert:</p>
<pre class="literal-block">
# big5 to utf-8
$ iconv -f big5 -t utf-8 big5.txt -o utf8.txt

# 簡體轉繁體
$ cat test.txt | iconv -f gb2312 -t big5

# 繁體轉簡體
$ cat test.txt | iconv -f big5 -t gb2312

# Big5 編碼跟 UTF-8 編碼之間的轉換,如 UTF-8 轉 Big5
$ cat test.txt | iconv -f utf-8 -t big5
</pre>
</div>
</div>
<div class="section" id="utils">
<h2>工具 utils</h2>
<p>壓縮/解壓縮 compress/depress:</p>
<pre class="literal-block">
## tar
# compress (tar 打包, zip壓縮)
$ tar -zcvf foo.tgz foo
# decompress
$ tar -zxvf foo.tgz

$ tar -jcvf foo.tar.bz2 foo
$ tar -jxvf too.tar.bz2

## bzip2
$ bzip2 foo # 會把 foo 變成 foo.bz2
$ bzip2 -d foo.bz2 # 把 foo.bz2 變 foo
</pre>
<p>bzip2 的壓縮率比較大, 運算時間長</p>
<div class="section" id="id4">
<h3>編輯</h3>
<ul class="simple">
<li><a class="reference external" href="http://coolshell.cn/articles/9070.html">AWK 简明教程 | 酷壳 - CoolShell.cn</a></li>
</ul>
<p>vim硬是要存檔:</p>
<pre class="literal-block">
:w !sudo tee %
</pre>
</div>
</div>
<div class="section" id="id5">
<h2>網路</h2>
<pre class="literal-block">
$ lsof # list open files
$ lsof -n # network files
$ lsof -i # monitors network connections in real time
$ iftop # shows bandwith usage per *connection*
$ nethogs #shows the bandwith usage per *process*

# iOS
$ sudo lsof -i -P
$ lsof -n -i4TCP:5000 | grep LISTEN # 找出port5000
</pre>
<p>rsync:</p>
<pre class="literal-block">
$ rsync -av /etc /tmp () # 將 /etc/ 的資料備份到 /tmp/etc 內(local)
$ rsync -av -e ssh user&#64;host:/etc /tmp 將遠端 /etc 備份到local主機的 /tmp 內
</pre>
<p>dns:</p>
<pre class="literal-block">
dig foobar.com        # simple query
dig +trace foobar.com # detail
dig +short foobar.com # 不廢話
dig foobar.com mx
</pre>
<p><em>.</em> 表示the root of the hierarchy</p>
<ul class="simple">
<li><a class="reference external" href="http://blog.longwin.com.tw/2010/02/netstat-check-connect-2010/">使用 netstat 找出不正常的連線 | Tsung's Blog</a></li>
</ul>
<p>curl:</p>
<pre class="literal-block">
curl http://example.com
curl http://example -d&quot;tag=foo&amp;cat=bar&quot; # 這個預設會送POST
curl http://example/edit -XPOST # http method
</pre>
</div>
<div class="section" id="service">
<h2>Service</h2>
<p>關掉uwsgi的process:</p>
<pre class="literal-block">
ps ca|grep uwsgi |awk '{ print $1}' | xargs --no-run-if-empty sudo kill -9
</pre>
<p>快速靜態檔案server:</p>
<pre class="literal-block">
$ python -m SimpleHTTPServer 8080
</pre>
<div class="section" id="crontab">
<h3>Crontab</h3>
<p>分鐘 小時 日期 月份 週</p>
<p>每5min一次:</p>
<pre class="literal-block">
*/5 * * * * /home/moogoo/test.sh
5 0 * * *
</pre>
<p>每小時:</p>
<pre class="literal-block">
01 * * * * /home/moogoo/test.sh
</pre>
<p>每天(半夜):</p>
<pre class="literal-block">
0 0 * * *
</pre>
<p>每週:</p>
<pre class="literal-block">
0 0 * * 0
</pre>
<p>每月:</p>
<pre class="literal-block">
0 0 1 * *
</pre>
<p>start:</p>
<pre class="literal-block">
service crond start
</pre>
</div>
</div>
<div class="section" id="system">
<h2>System</h2>
<p>語系:</p>
<pre class="literal-block">
$ locale -a # 目前系統支援語系
$ dpkg-reconfigure locales 安裝語系
</pre>
</div>

    </div><!-- /.entry-content -->
        <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "computer/unix_command.html";
        var disqus_url = "http://blog.suhen.org/computer/unix_command.html";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://suhenorg.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
    
  </article>
</section>
        <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="/pages/about.html">About</a></li>
                                                    <li><a href="http://blog.roodo.com/moogoo">舊blog</a></li>
                                                    <li><a href="http://moogoo78.blogspot.com">電腦程式blog</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://blog.suhen.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://www.facebook.com/moogee.lee">facebook</a></li>
                                                    <li><a href="http://twitter.com/moogoo">twitter</a></li>
                                                    <li><a href="http://github.com/moogoo78">github</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
<!-- Site Meter -->
<script type="text/javascript" src="http://s51.sitemeter.com/js/counter.js?site=s51blogsuhen">
</script>
<noscript>
<a href="http://s51.sitemeter.com/stats.asp?site=s51blogsuhen" target="_top">
<img src="http://s51.sitemeter.com/meter.asp?site=s51blogsuhen" alt="Site Meter" border="0"/></a>
</noscript>
<!-- Copyright (c)2009 Site Meter -->
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38928548-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'suhenorg';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>